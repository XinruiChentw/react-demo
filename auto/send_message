#!/usr/bin/env bash
set -e

message_to_send() {
  cat <<EOF
{
    "msgtype": "markdown",
    "markdown": {
        "content": "Ooops!! The pipeline failed. \n
         >commit id:<font color=\"comment\">$1</font>
         >repo name:<font color=\"comment\">$2</font>
         >branch name:<font color=\"comment\">$3</font>
         >person:<font color=\"comment\">$4</font>
         >action path:<font color=\"comment\">$5</font>
         You can check it here [failed pipeline](https://github.com/$2/actions/runs/$5)
    }
}
EOF
}

curl -H "Content-Type: application/json" -X POST -d "$(message_to_send $1 $2 $3 $4 $5)" $6